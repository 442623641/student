<!--
  Generated template for the ExamsPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>
  <ion-navbar>
    <ion-title>成绩单</ion-title>
  </ion-navbar>
</ion-header>
<ion-content>
  <ion-refresher (ionRefresh)="doRefresh($event)">
    <ion-refresher-content pullingText="" refreshingSpinner="circles" refreshingText="">
    </ion-refresher-content>
  </ion-refresher>
  <ng-template [ngIf]="latest" [ngIfElse]="loading">
    <div class="banner" *ngIf="waterball">
      <h3>{{latest.name}}</h3>
      <p ion-text color="gray9">发布时间：{{latest.time}}</p>
      <echarts-ng2 [option]="waterball" [style]="{'height': '210px'}"></echarts-ng2>
      <ion-row justify-content-between>
        <ion-col col-6>
          <button ion-button outline block [navPush]='pages.report' [navParams]="latest">学情报告</button>
        </ion-col>
        <ion-col col-6 [ngSwitch]="!!latest.payment">
          <button *ngSwitchCase="true" ion-button outline block color="green" [navPush]='pages.doctor' [navParams]="latest">错题诊断</button>
          <button *ngSwitchCase="false" ion-button outline block color="green" [navPush]='pages.reply' [navParams]="latest">答题情况</button>
        </ion-col>
      </ion-row>
    </div>
    <ion-list no-lines *ngIf="exams.length">
      <ion-card *ngFor="let exam of exams">
        <ion-item class="card-header" no-lines>
          <ion-label>{{exam.name}}</ion-label>
          <span item-right *ngIf="exam.payment">已生成</span>
        </ion-item>
        <ion-row nowrap justify-content-start class="desc">
          <ion-col col-auto text-left>
            <ion-icon name="time-outline"></ion-icon> 发布时间：{{exam.time}}</ion-col>
        </ion-row>
        <ion-row class="footer" [ngSwitch]="!!exam.payment">
          <a [navPush]='pages.report' [navParams]="exam">学情报告</a>
          <a *ngSwitchCase="true" [navPush]='pages.doctor' [navParams]="exam">错题诊断</a>
          <a *ngSwitchCase="false" [navPush]='pages.reply' [navParams]="exam">答题情况</a>
        </ion-row>
      </ion-card>
    </ion-list>
    <ion-infinite-scroll (ionInfinite)="doInfinite($event)" *ngIf="exams.length<total">
      <ion-infinite-scroll-content></ion-infinite-scroll-content>
    </ion-infinite-scroll>
  </ng-template>
  <ng-template #loading>
    <loading [status]="latest"></loading>
  </ng-template>
</ion-content>
